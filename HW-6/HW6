-- Проанализировать запросы, которые выполнялись на занятии, определить возможные корректировки и/или улучшения (JOIN пока не применять).

 -- Проанализировал, но пока ничего конструктивного не могу предложить.. Раньше подобные задачи(1с) решалось соединением таблиц, тут пока это запрещено.. 

-- Пусть задан некоторый пользователь. 
-- Из всех друзей этого пользователя найдите человека, который больше всех общался с нашим пользователем

SELECT from_user_id, COUNT(to_user_id)  FROM messages where to_user_id = 1 GROUP by from_user_id
 
UNION
 
 SELECT to_user_id, COUNT(from_user_id)  FROM messages where from_user_id = 1 GROUP by to_user_id
 
 
 -- Подсчитать общее количество лайков, которые получили 10 самых молодых пользователей.
 
 SELECT COUNT(*) from likes WHERE user_id in (select user_id from profiles ORDER by birthday DESC LIMIT 10)  
 
 -- Определить кто больше поставил лайков (всего) - мужчины или женщины?
 
 select gender, COUNT(*) from profiles where user_id in (select user_id from likes) GROUP by gender
 
 
 -- Найти 10 пользователей, которые проявляют наименьшую активность в использовании социальной сети.
 
 -- Не до конца понятно условие, наименьшая активность, в отправке сообщений, или в лайках, медия..